<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>URL Shortener</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>Link Shortener</h1>
        <p>Enter a long URL to make it short and easy to share.</p>
        <div class="input-container">
            <input type="url" id="long-url-input" placeholder="https://example.com/very-long-url-to-shorten">
            <button id="shorten-btn">Shorten</button>
        </div>
        <div id="result-container" class="hidden">
            <p>Your short link is ready:</p>
            <div class="short-link-box">
                <a href="" id="short-url-link" target="_blank"></a>
                <button id="copy-btn">Copy</button>
            </div>
        </div>
         <p id="loading-message" class="hidden">Shortening...</p>
    </div>

    <script>
        document.getElementById('shorten-btn').addEventListener('click', async () => {
            const longUrlInput = document.getElementById('long-url-input');
            const longUrl = longUrlInput.value.trim();
            const loadingMessage = document.getElementById('loading-message');
            
            if (!longUrl) {
                alert('Please enter a URL.');
                return;
            }

            loadingMessage.classList.remove('hidden');
            document.getElementById('result-container').classList.add('hidden');

            try {
                const response = await fetch('/api/create', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ url: longUrl })
                });

                const data = await response.json();

                if (response.ok && data.shortUrl) {
                    const shortUrlLink = document.getElementById('short-url-link');
                    shortUrlLink.href = data.shortUrl;
                    shortUrlLink.textContent = data.shortUrl.replace(/^https?:\/\//, ''); // http/https ছাড়া লিঙ্ক দেখানো
                    document.getElementById('result-container').classList.remove('hidden');
                } else {
                    alert(data.error || 'Something went wrong. Please try again.');
                }
            } catch (error) {
                alert('An error occurred. Please check your connection.');
            } finally {
                loadingMessage.classList.add('hidden');
            }
        });

        document.getElementById('copy-btn').addEventListener('click', () => {
            const shortUrl = document.getElementById('short-url-link').href;
            navigator.clipboard.writeText(shortUrl).then(() => {
                alert('Copied to clipboard!');
            });
        });
    </script>
</body>
</html>
